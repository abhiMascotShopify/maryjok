{
  "version": 3,
  "sources": ["../../../../app/routes/($locale).account.profile.jsx"],
  "sourcesContent": ["import {json, redirect} from '@shopify/remix-oxygen';\nimport React, { useState } from 'react';\nimport {\n  Form,\n  useActionData,\n  useNavigation,\n  useOutletContext,\n} from '@remix-run/react';\n\nexport const meta = () => {\n  return [{title: 'Profile'}];\n};\n\nexport async function loader({context}) {\n  const customerAccessToken = await context.session.get('customerAccessToken');\n  if (!customerAccessToken) {\n    return redirect('/account/login');\n  }\n  return json({});\n}\n\nexport async function action({request, context}) {\n  const {session, storefront} = context;\n\n  if (request.method !== 'PUT') {\n    return json({error: 'Method not allowed'}, {status: 405});\n  }\n\n  const form = await request.formData();\n  const customerAccessToken = await session.get('customerAccessToken');\n  if (!customerAccessToken) {\n    return json({error: 'Unauthorized'}, {status: 401});\n  }\n\n  try {\n    const password = getPassword(form);\n    const customer = {};\n    const validInputKeys = [\n      'firstName',\n      'lastName',\n      'email',\n      'password',\n      'phone',\n    ];\n    for (const [key, value] of form.entries()) {\n      if (!validInputKeys.includes(key)) {\n        continue;\n      }\n      if (key === 'acceptsMarketing') {\n        customer.acceptsMarketing = value === 'on';\n      }\n      if (typeof value === 'string' && value.length) {\n        customer[key] = value;\n      }\n    }\n\n    if (password) {\n      customer.password = password;\n    }\n\n    // update customer and possibly password\n    const updated = await storefront.mutate(CUSTOMER_UPDATE_MUTATION, {\n      variables: {\n        customerAccessToken: customerAccessToken.accessToken,\n        customer,\n      },\n    });\n\n    // check for mutation errors\n    if (updated.customerUpdate?.customerUserErrors?.length) {\n      return json(\n        {error: updated.customerUpdate?.customerUserErrors[0]},\n        {status: 400},\n      );\n    }\n\n    // update session with the updated access token\n    if (updated.customerUpdate?.customerAccessToken?.accessToken) {\n      session.set(\n        'customerAccessToken',\n        updated.customerUpdate?.customerAccessToken,\n      );\n    }\n\n    return json(\n      {error: null, customer: updated.customerUpdate?.customer},\n      {\n        headers: {\n          'Set-Cookie': await session.commit(),\n        },\n      },\n    );\n  } catch (error) {\n    return json({error: error.message, customer: null}, {status: 400});\n  }\n}\n\nexport default function AccountProfile() {\n  const account = useOutletContext();\n  const {state} = useNavigation();\n  const action = useActionData();\n  const customer = action?.customer ?? account?.customer;\n  const [activeTab, setActiveTab] = useState('profile');\n\n  const handleTabChange = (tab) => {\n    setActiveTab(tab);\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    // You can handle the form submission here.\n    // Combine profileData and passwordData as needed.\n\n    console.log('Profile Data:', profileData);\n    console.log('Password Data:', passwordData);\n  };\n\n  return (\n    <>\n    <div className=\"w-full h-full justify-center items-center\">\n      <Form className=\"w-full justify-center items-center\" method=\"PUT\">\n      <fieldset>\n        <div className=\"mb-3\" >\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"firstName\">First name</label>\n          <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            id=\"firstName\"\n            name=\"firstName\"\n            type=\"text\"\n            autoComplete=\"given-name\"\n            placeholder=\"First name\"\n            aria-label=\"First name\"\n            defaultValue={customer.firstName ?? ''}\n            minLength={2}\n          />\n          </div>\n          <div className=\"mb-3\" >\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"lastName\">Last name</label>\n          <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            id=\"lastName\"\n            name=\"lastName\"\n            type=\"text\"\n            autoComplete=\"family-name\"\n            placeholder=\"Last name\"\n            aria-label=\"Last name\"\n            defaultValue={customer.lastName ?? ''}\n            minLength={2}\n          />\n          </div>\n          <div className=\"mb-3\" >\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"phone\">Mobile</label>\n          <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            id=\"phone\"\n            name=\"phone\"\n            type=\"tel\"\n            autoComplete=\"tel\"\n            placeholder=\"Mobile\"\n            aria-label=\"Mobile\"\n            defaultValue={customer.phone ?? ''}\n          />\n          </div>\n          <div className=\"mb-3\" >\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"email\">Email address</label>\n          <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            id=\"email\"\n            name=\"email\"\n            type=\"email\"\n            autoComplete=\"email\"\n            required\n            placeholder=\"Email address\"\n            aria-label=\"Email address\"\n            defaultValue={customer.email ?? ''}\n          />\n          </div>\n        <div className=\"mb-3\" >\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"currentPassword\">Current password</label>\n          <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            id=\"currentPassword\"\n            name=\"currentPassword\"\n            type=\"password\"\n            autoComplete=\"current-password\"\n            placeholder=\"Current password\"\n            aria-label=\"Current password\"\n            minLength={8}\n          />\n          </div>\n          <div className=\"mb-3\" >\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"newPassword\">New password</label>\n          <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            id=\"newPassword\"\n            name=\"newPassword\"\n            type=\"password\"\n            placeholder=\"New password\"\n            aria-label=\"New password\"\n            minLength={8}\n          />\n          </div>\n          <small>Passwords must be at least 8 characters.</small>\n        </fieldset>\n        <div className=\"flex items-center justify-between\">\n      <button className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\" \n      type=\"submit\" disabled={state !== 'idle'}>\n      {state !== 'idle' ? 'Updating' : 'Update'}\n      </button>\n      <a className=\"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800\" href=\"/account/recover\">\n        Forgot Password?\n      </a>\n    </div>\n      </Form>\n      </div>\n        {/*\n        <div className=\"w-full h-full justify-center items-center\">\n      <div className=\"flex justify-center items-center\">\n        <button\n          onClick={() => handleTabChange('profile')}\n          className={`${\n            activeTab === 'profile' ? 'bg-blue-500 text-white' : 'bg-gray-300'\n          } px-10 py-2 rounded-l`}\n        >\n          Profile\n        </button>\n        <button\n          onClick={() => handleTabChange('password')}\n          className={`${\n            activeTab === 'password' ? 'bg-blue-500 text-white' : 'bg-gray-300'\n          } px-4 py-2 rounded-r`}\n        >\n          Change Password\n        </button>\n      </div>\n      <div className=\"mt-4 p-4 justify-center items-center\">\n        {activeTab === 'profile' ? (\n          <Form className=\"w-full justify-center items-center\" method=\"PUT\">\n          <fieldset>\n           <div className=\"mb-3\" >\n             <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"username\">\n               Email\n             </label>\n             <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \n               id=\"email\"\n               name=\"email\"\n               type=\"email\"\n               autoComplete=\"email\"\n               required\n               placeholder=\"Email address\"\n               aria-label=\"Email address\"\n               defaultValue={customer.email ?? ''}\n               disabled/>\n           </div>\n           <div className=\"mb-3\" >\n             <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"username\">\n               First Name\n             </label>\n             <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \n               id=\"firstName\"\n               name=\"firstName\"\n               type=\"text\"\n               autoComplete=\"given-name\"\n               placeholder=\"First name\"\n               aria-label=\"First name\"\n               defaultValue={customer.firstName ?? ''}\n               minLength={2}/>\n           </div>\n           <div className=\"mb-3\" >\n             <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"username\">\n               Last Name\n             </label>\n             <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \n               id=\"lastName\"\n               name=\"lastName\"\n               type=\"text\"\n               autoComplete=\"family-name\"\n               placeholder=\"Last name\"\n               aria-label=\"Last name\"\n               defaultValue={customer.lastName ?? ''}\n               minLength={2}/>\n           </div>\n           <div className=\"mb-3\" >\n             <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"username\">\n               Phone\n             </label>\n             <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \n               id=\"phone\"\n               name=\"phone\"\n               type=\"tel\"\n               autoComplete=\"tel\"\n               placeholder=\"Mobile\"\n               aria-label=\"Mobile\"\n               defaultValue={customer.phone ?? ''}/>\n           </div>\n            </fieldset>\n           <div className=\"flex items-center justify-between\">\n             <button className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\" type=\"submit\">\n               Update\n             </button>\n             <a className=\"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800\" href=\"/account/recover\">\n               Forgot Password?\n             </a>\n           </div>\n         </Form>\n        ) : (\n          <Form className=\"w-full justify-center items-center\" method=\"POST\">\n   <fieldset>\n    <div className=\"mb-3\" >\n      <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"username\">\n        Current Password\n      </label>\n      <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \n        id=\"currentPassword\"\n        name=\"currentPassword\"\n        type=\"password\"\n        aria-label=\"Current password\"\n        minLength={8} required/>\n    </div>\n    <div className=\"mb-4\">\n      <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"password\">\n       New Password\n      </label>\n      <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\" \n      id=\"password\"\n      name=\"password\"\n      type=\"password\"\n      aria-label=\"Password\"\n      minLength={8}\n      required/>\n    </div>\n    <div className=\"mb-4\">\n      <label className=\"block text-gray-700 text-sm font-bold mb-2\" for=\"password\">\n       Confirm New Password\n      </label>\n      <input className=\"shadow appearance-none border rounded w-full py-1 px-2 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\" \n      id=\"newPasswordConfirm\"\n      name=\"newPasswordConfirm\"\n      type=\"password\"\n      aria-label=\"New password confirm\"\n      minLength={8}/>\n    </div>\n     </fieldset>\n    <div className=\"flex items-center justify-between\">\n      <button className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\" type=\"submit\">\n        Update\n      </button>\n      <a className=\"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800\" href=\"/account/recover\">\n        Forgot Password?\n      </a>\n    </div>\n  </Form>\n        )}\n      </div>\n        </div>*/}\n     </>   \n  );\n}\n\nfunction getPassword(form) {\n  let password;\n  const currentPassword = form.get('currentPassword');\n  const newPassword = form.get('newPassword');\n  const newPasswordConfirm = form.get('newPasswordConfirm');\n\n  let passwordError;\n  if (newPassword && !currentPassword) {\n    passwordError = new Error('Current password is required.');\n  }\n\n  if (newPassword && newPassword !== newPasswordConfirm) {\n    passwordError = new Error('New passwords must match.');\n  }\n\n  if (newPassword && currentPassword && newPassword === currentPassword) {\n    passwordError = new Error(\n      'New password must be different than current password.',\n    );\n  }\n\n  if (passwordError) {\n    throw passwordError;\n  }\n\n  if (currentPassword && newPassword) {\n    password = newPassword;\n  } else {\n    password = currentPassword;\n  }\n\n  return String(password);\n}\n\nconst CUSTOMER_UPDATE_MUTATION = `#graphql\n  # https://shopify.dev/docs/api/storefront/latest/mutations/customerUpdate\n  mutation customerUpdate(\n    $customerAccessToken: String!,\n    $customer: CustomerUpdateInput!\n    $country: CountryCode\n    $language: LanguageCode\n  ) @inContext(language: $language, country: $country) {\n    customerUpdate(customerAccessToken: $customerAccessToken, customer: $customer) {\n      customer {\n        acceptsMarketing\n        email\n        firstName\n        id\n        lastName\n        phone\n      }\n      customerAccessToken {\n        accessToken\n        expiresAt\n      }\n      customerUserErrors {\n        code\n        field\n        message\n      }\n    }\n  }\n`;\n"],
  "mappings": "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",
  "names": []
}
