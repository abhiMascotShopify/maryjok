import{a as R,b as k,c as S}from"/build/_shared/chunk-4UNU5TGX.js";import{a as L,f,j as m,l as o,t as v,u as g,x as y}from"/build/_shared/chunk-G7BGYXZV.js";import{d as h}from"/build/_shared/chunk-G5WX4PPA.js";var a=h(L());var e=h(y()),N=[{type:"queries",items:[]},{type:"products",items:[]},{type:"collections",items:[]},{type:"pages",items:[]},{type:"articles",items:[]}];function O({searchTerm:s}){let t=(0,a.useRef)(null);return(0,a.useEffect)(()=>{function n(r){r.key==="k"&&r.metaKey&&(r.preventDefault(),t.current?.focus()),r.key==="Escape"&&t.current?.blur()}return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[]),(0,e.jsxs)(m,{method:"get",children:[(0,e.jsx)("input",{defaultValue:s,name:"q",placeholder:"Search\u2026",ref:t,type:"search"}),"\xA0",(0,e.jsx)("button",{type:"submit",children:"Search from custom"})]})}function G({results:s}){if(!s)return null;let t=Object.keys(s);return console.log(s),(0,e.jsx)("div",{children:s&&t.map(n=>{let r=s[n];if(r.nodes[0]?.__typename==="Page"){let i=r;return r.nodes.length?(0,e.jsx)(E,{pages:i},"pages"):null}if(r.nodes[0]?.__typename==="Product"){let i=r;return r.nodes.length?(0,e.jsx)(q,{products:i},"products"):null}if(r.nodes[0]?.__typename==="Article"){let i=r;return r.nodes.length?(0,e.jsx)(_,{articles:i},"articles"):null}return null})})}function q({products:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h3",{children:"Products"}),(0,e.jsx)(S,{connection:s,children:({nodes:t,isLoading:n,NextLink:r,PreviousLink:i})=>{let c=t.map(u=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/products/${u.handle}`,children:(0,e.jsx)("span",{children:u.title})})},u.id));return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(0,e.jsx)(i,{children:n?"Loading...":(0,e.jsx)("span",{children:"\u2191 Load previous"})})}),(0,e.jsxs)("div",{children:[c,(0,e.jsx)("br",{})]}),(0,e.jsx)("div",{children:(0,e.jsx)(r,{children:n?"Loading...":(0,e.jsx)("span",{children:"Load more \u2193"})})})]})}}),(0,e.jsx)("br",{})]})}function E({pages:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{children:"Pages"}),(0,e.jsx)("div",{children:s?.nodes?.map(t=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/pages/${t.handle}`,children:t.title})},t.id))}),(0,e.jsx)("br",{})]})}function _({articles:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{children:"Articles"}),(0,e.jsx)("div",{children:s?.nodes?.map(t=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/blog/${t.handle}`,children:t.title})},t.id))}),(0,e.jsx)("br",{})]})}function U(){return(0,e.jsx)("div",{children:"No results, try a different search."})}function M({action:s,children:t,className:n="predictive-search-form",method:r="POST",...i}){let c=f(),u=g(),l=(0,a.useRef)(null);function P(d){let p=s??"/api/predictive-search",T=c.locale?`/${c.locale}${p}`:p,b=d.target.value||"";u.submit({q:b,limit:"6"},{method:r,action:T})}return(0,a.useEffect)(()=>{l?.current?.setAttribute("type","search")},[]),(0,e.jsx)(u.Form,{...i,className:n,onSubmit:d=>{d.preventDefault(),d.stopPropagation(),!(!l?.current||l.current.value==="")&&l.current.blur()},children:t({fetchResults:P,inputRef:l,fetcher:u})})}function V(){let{results:s,totalResults:t,searchInputRef:n,searchTerm:r}=A();function i(c){n.current&&(n.current.blur(),n.current.value="",window.location.href=c.currentTarget.href)}return t?(0,e.jsxs)("div",{className:"predictive-search-results w-[270px] lg:w-[470px] absolute right-0",children:[(0,e.jsx)("div",{children:s.map(({type:c,items:u})=>(0,e.jsx)(w,{goToSearchResult:i,items:u,searchTerm:r,type:c},c))}),r.current&&(0,e.jsx)(o,{onClick:i,to:`/search?q=${r.current}`,children:(0,e.jsxs)("div",{children:["View all results for ",(0,e.jsx)("q",{children:r.current}),"\xA0 \u2192"]})})]}):(0,e.jsx)(e.Fragment,{})}function w({goToSearchResult:s,items:t,searchTerm:n,type:r}){let i=r==="queries",c=`/search?q=${n.current}&type=${F(r)}`;return(0,e.jsx)("div",{className:"predictive-search-result",children:(0,e.jsx)("ul",{children:t.map(u=>(0,e.jsx)(x,{goToSearchResult:s,item:u},u.id))})},r)}function x({goToSearchResult:s,item:t}){return(0,e.jsx)("li",{className:"predictive-search-result-item",children:(0,e.jsxs)(o,{onClick:s,to:t.url,children:[t.image?.url&&(0,e.jsx)(k,{alt:t.image.altText??"",src:t.image.url,width:50,height:50}),(0,e.jsxs)("div",{children:[t.styledTitle?(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:t.styledTitle}}):(0,e.jsx)("span",{children:t.title}),t?.price&&(0,e.jsx)("small",{children:(0,e.jsx)(R,{data:t.price})})]})]})},t.id)}function A(){let s=v(),t=(0,a.useRef)(""),n=(0,a.useRef)(null),r=s.find(c=>c.data?.searchResults);r?.state==="loading"&&(t.current=r.formData?.get("q")||"");let i=r?.data?.searchResults||{results:N,totalResults:0};return(0,a.useEffect)(()=>{n.current||(n.current=document.querySelector('input[type="search"]'))},[]),{...i,searchInputRef:n,searchTerm:t}}function F(s){let t={articles:"ARTICLE",collections:"COLLECTION",pages:"PAGE",products:"PRODUCT",queries:"QUERY"};return typeof s=="string"?t[s]:s.map(n=>t[n]).join(",")}export{O as a,G as b,U as c,M as d,V as e};
